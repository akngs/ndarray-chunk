!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.chunk=e():r.chunk=e()}(this,function(){return function(r){function e(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return r[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=r,e.c=t,e.p="",e(0)}([function(r,e,t){"use strict";function n(r){return r&&r.__esModule?r:{"default":r}}function o(r,e){if(r=r.shape?r:(0,s["default"])(r),r.shape.length!==e.length)throw new Error("Shape mismatch");for(var t=e.length,n=[],o=[],a=0;t>a;++a)n.push(r.shape[a]%e[a]),o.push(Math.floor(r.shape[a]/e[a])+!!n[a]);var i=[],u=[],p=[],h=i;if(2===t)for(var c=0;c<o[0];++c){h=i[c]=[],u[0]=Math.min(c*e[0]+e[0],r.shape[0]),p[0]=c*e[0];for(var a=0;a<o[1];++a){var f,l;u[1]=Math.min(a*e[1]+e[1],r.shape[1]),p[1]=a*e[1],h[a]=(f=(l=r).hi.apply(l,u)).lo.apply(f,p)}}else for(var a=0;a<o[0];++a){var d,g;u[0]=Math.min(a*e[0]+e[0],r.shape[0]),p[0]=a*e[0],h[a]=(d=(g=r).hi.apply(g,u)).lo.apply(d,p)}return i}Object.defineProperty(e,"__esModule",{value:!0}),e.chunk=void 0;var a=t(1),s=n(a);e.chunk=o},function(r,e,t){"use strict";var n=t(2),o=t(5);r.exports=function(r,e){for(var t=[],a=r,s=1;a instanceof Array;)t.push(a.length),s*=a.length,a=a[0];return 0===t.length?n():(e||(e=n(new Float64Array(s),t)),o(e,r),e)}},function(r,e,t){function n(r,e){return r[0]-e[0]}function o(){var r,e=this.stride,t=new Array(e.length);for(r=0;r<t.length;++r)t[r]=[Math.abs(e[r]),r];t.sort(n);var o=new Array(t.length);for(r=0;r<o.length;++r)o[r]=t[r][1];return o}function a(r,e){var t=["View",e,"d",r].join("");0>e&&(t="View_Nil"+r);var n="generic"===r;if(-1===e){var a="function "+t+"(a){this.data=a;};	var proto="+t+".prototype;	proto.dtype='"+r+"';	proto.index=function(){return -1};	proto.size=0;	proto.dimension=-1;	proto.shape=proto.stride=proto.order=[];	proto.lo=proto.hi=proto.transpose=proto.step=	function(){return new "+t+"(this.data);};	proto.get=proto.set=function(){};	proto.pick=function(){return null};	return function construct_"+t+"(a){return new "+t+"(a);}",s=new Function(a);return s()}if(0===e){var a="function "+t+"(a,d) {	this.data = a;	this.offset = d	};	var proto="+t+".prototype;	proto.dtype='"+r+"';	proto.index=function(){return this.offset};	proto.dimension=0;	proto.size=1;	proto.shape=	proto.stride=	proto.order=[];	proto.lo=	proto.hi=	proto.transpose=	proto.step=function "+t+"_copy() {	return new "+t+"(this.data,this.offset)	};	proto.pick=function "+t+"_pick(){	return TrivialArray(this.data);	};	proto.valueOf=proto.get=function "+t+"_get(){	return "+(n?"this.data.get(this.offset)":"this.data[this.offset]")+"};	proto.set=function "+t+"_set(v){	return "+(n?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"	};	return function construct_"+t+"(a,b,c,d){return new "+t+"(a,d)}",s=new Function("TrivialArray",a);return s(c[r][0])}var a=["'use strict'"],i=u(e),p=i.map(function(r){return"i"+r}),h="this.offset+"+i.map(function(r){return"this.stride["+r+"]*i"+r}).join("+"),f=i.map(function(r){return"b"+r}).join(","),l=i.map(function(r){return"c"+r}).join(",");a.push("function "+t+"(a,"+f+","+l+",d){this.data=a","this.shape=["+f+"]","this.stride=["+l+"]","this.offset=d|0}","var proto="+t+".prototype","proto.dtype='"+r+"'","proto.dimension="+e),a.push("Object.defineProperty(proto,'size',{get:function "+t+"_size(){	return "+i.map(function(r){return"this.shape["+r+"]"}).join("*"),"}})"),1===e?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),4>e?(a.push("function "+t+"_order(){"),2===e?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);	if(s0>s1){	if(s1>s2){	return [2,1,0];	}else if(s0>s2){	return [1,2,0];	}else{	return [1,0,2];	}	}else if(s0>s2){	return [2,0,1];	}else if(s2>s1){	return [0,1,2];	}else{	return [0,2,1];	}}})")):a.push("ORDER})")),a.push("proto.set=function "+t+"_set("+p.join(",")+",v){"),n?a.push("return this.data.set("+h+",v)}"):a.push("return this.data["+h+"]=v}"),a.push("proto.get=function "+t+"_get("+p.join(",")+"){"),n?a.push("return this.data.get("+h+")}"):a.push("return this.data["+h+"]}"),a.push("proto.index=function "+t+"_index(",p.join(),"){return "+h+"}"),a.push("proto.hi=function "+t+"_hi("+p.join(",")+"){return new "+t+"(this.data,"+i.map(function(r){return["(typeof i",r,"!=='number'||i",r,"<0)?this.shape[",r,"]:i",r,"|0"].join("")}).join(",")+","+i.map(function(r){return"this.stride["+r+"]"}).join(",")+",this.offset)}");var d=i.map(function(r){return"a"+r+"=this.shape["+r+"]"}),g=i.map(function(r){return"c"+r+"=this.stride["+r+"]"});a.push("proto.lo=function "+t+"_lo("+p.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+g.join(","));for(var y=0;e>y;++y)a.push("if(typeof i"+y+"==='number'&&i"+y+">=0){	d=i"+y+"|0;	b+=c"+y+"*d;	a"+y+"-=d}");a.push("return new "+t+"(this.data,"+i.map(function(r){return"a"+r}).join(",")+","+i.map(function(r){return"c"+r}).join(",")+",b)}"),a.push("proto.step=function "+t+"_step("+p.join(",")+"){var "+i.map(function(r){return"a"+r+"=this.shape["+r+"]"}).join(",")+","+i.map(function(r){return"b"+r+"=this.stride["+r+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var y=0;e>y;++y)a.push("if(typeof i"+y+"==='number'){	d=i"+y+"|0;	if(d<0){	c+=b"+y+"*(a"+y+"-1);	a"+y+"=ceil(-a"+y+"/d)	}else{	a"+y+"=ceil(a"+y+"/d)	}	b"+y+"*=d	}");a.push("return new "+t+"(this.data,"+i.map(function(r){return"a"+r}).join(",")+","+i.map(function(r){return"b"+r}).join(",")+",c)}");for(var v=new Array(e),j=new Array(e),y=0;e>y;++y)v[y]="a[i"+y+"]",j[y]="b[i"+y+"]";a.push("proto.transpose=function "+t+"_transpose("+p+"){"+p.map(function(r,e){return r+"=("+r+"===undefined?"+e+":"+r+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+t+"(this.data,"+v.join(",")+","+j.join(",")+",this.offset)}"),a.push("proto.pick=function "+t+"_pick("+p+"){var a=[],b=[],c=this.offset");for(var y=0;e>y;++y)a.push("if(typeof i"+y+"==='number'&&i"+y+">=0){c=(c+this.stride["+y+"]*i"+y+")|0}else{a.push(this.shape["+y+"]);b.push(this.stride["+y+"])}");a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+t+"(data,shape,stride,offset){return new "+t+"(data,"+i.map(function(r){return"shape["+r+"]"}).join(",")+","+i.map(function(r){return"stride["+r+"]"}).join(",")+",offset)}");var s=new Function("CTOR_LIST","ORDER",a.join("\n"));return s(c[r],o)}function s(r){if(p(r))return"buffer";if(h)switch(Object.prototype.toString.call(r)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(r)?"array":"generic"}function i(r,e,t,n){if(void 0===r){var o=c.array[0];return o([])}"number"==typeof r&&(r=[r]),void 0===e&&(e=[r.length]);var i=e.length;if(void 0===t){t=new Array(i);for(var u=i-1,p=1;u>=0;--u)t[u]=p,p*=e[u]}if(void 0===n){n=0;for(var u=0;i>u;++u)t[u]<0&&(n-=(e[u]-1)*t[u])}for(var h=s(r),f=c[h];f.length<=i+1;)f.push(a(h,f.length-1));var o=f[i+1];return o(r,e,t,n)}var u=t(3),p=t(4),h="undefined"!=typeof Float64Array,c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};r.exports=i},function(r,e){"use strict";function t(r){for(var e=new Array(r),t=0;r>t;++t)e[t]=t;return e}r.exports=t},function(r,e){r.exports=function(r){return!(null==r||!(r._isBuffer||r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r)))}},function(r,e,t){r.exports=t(6)({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},function(r,e,t){"use strict";function n(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function o(r){var e=new n;e.pre=r.pre,e.body=r.body,e.post=r.post;var t=r.args.slice(0);e.argTypes=t;for(var o=0;o<t.length;++o){var s=t[o];if("array"===s||"object"==typeof s&&s.blockIndices){if(e.argTypes[o]="array",e.arrayArgs.push(o),e.arrayBlockIndices.push(s.blockIndices?s.blockIndices:0),e.shimArgs.push("array"+o),o<e.pre.args.length&&e.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<e.post.args.length&&e.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===s)e.scalarArgs.push(o),e.shimArgs.push("scalar"+o);else if("index"===s){if(e.indexArgs.push(o),o<e.pre.args.length&&e.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<e.body.args.length&&e.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<e.post.args.length&&e.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===s){if(e.shapeArgs.push(o),o<e.pre.args.length&&e.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<e.body.args.length&&e.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<e.post.args.length&&e.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof s||!s.offset)throw new Error("cwise: Unknown argument type "+t[o]);e.argTypes[o]="offset",e.offsetArgs.push({array:s.array,offset:s.offset}),e.offsetArgIndex.push(o)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>t.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>t.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>t.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!r.printCode||!!r.debug,e.funcName=r.funcName||"cwise",e.blockSize=r.blockSize||64,a(e)}var a=t(7);r.exports=o},function(r,e,t){"use strict";function n(r){var e=["'use strict'","var CACHED={}"],t=[],n=r.funcName+"_cwise_thunk";e.push(["return function ",n,"(",r.shimArgs.join(","),"){"].join(""));for(var a=[],s=[],i=[["array",r.arrayArgs[0],".shape.slice(",Math.max(0,r.arrayBlockIndices[0]),r.arrayBlockIndices[0]<0?","+r.arrayBlockIndices[0]+")":")"].join("")],u=[],p=[],h=0;h<r.arrayArgs.length;++h){var c=r.arrayArgs[h];t.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),a.push("t"+c),a.push("r"+c),s.push("t"+c),s.push("r"+c+".join()"),i.push("array"+c+".data"),i.push("array"+c+".stride"),i.push("array"+c+".offset|0"),h>0&&(u.push("array"+r.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(r.arrayBlockIndices[0])-Math.abs(r.arrayBlockIndices[h]))),p.push("array"+r.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[h])+"]"))}r.arrayArgs.length>1&&(e.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),e.push("for(var shapeIndex=array"+r.arrayArgs[0]+".shape.length-"+Math.abs(r.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),e.push("if (!("+p.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}"));for(var h=0;h<r.scalarArgs.length;++h)i.push("scalar"+r.scalarArgs[h]);t.push(["type=[",s.join(","),"].join()"].join("")),t.push("proc=CACHED[type]"),e.push("var "+t.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",i.join(","),")}"].join("")),r.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------");var f=new Function("compile",e.join("\n"));return f(o.bind(void 0,r))}var o=t(8);r.exports=n},function(r,e,t){"use strict";function n(r,e,t){var n,o,a=r.length,s=e.arrayArgs.length,i=e.indexArgs.length>0,u=[],p=[],h=0,c=0;for(n=0;a>n;++n)p.push(["i",n,"=0"].join(""));for(o=0;s>o;++o)for(n=0;a>n;++n)c=h,h=r[n],0===n?p.push(["d",o,"s",n,"=t",o,"p",h].join("")):p.push(["d",o,"s",n,"=(t",o,"p",h,"-s",c,"*t",o,"p",c,")"].join(""));for(u.push("var "+p.join(",")),n=a-1;n>=0;--n)h=r[n],u.push(["for(i",n,"=0;i",n,"<s",h,";++i",n,"){"].join(""));for(u.push(t),n=0;a>n;++n){for(c=h,h=r[n],o=0;s>o;++o)u.push(["p",o,"+=d",o,"s",n].join(""));i&&(n>0&&u.push(["index[",c,"]-=s",c].join("")),u.push(["++index[",h,"]"].join(""))),u.push("}")}return u.join("\n")}function o(r,e,t,o){for(var a=e.length,s=t.arrayArgs.length,i=t.blockSize,u=t.indexArgs.length>0,p=[],h=0;s>h;++h)p.push(["var offset",h,"=p",h].join(""));for(var h=r;a>h;++h)p.push(["for(var j"+h+"=SS[",e[h],"]|0;j",h,">0;){"].join("")),p.push(["if(j",h,"<",i,"){"].join("")),p.push(["s",e[h],"=j",h].join("")),p.push(["j",h,"=0"].join("")),p.push(["}else{s",e[h],"=",i].join("")),p.push(["j",h,"-=",i,"}"].join("")),u&&p.push(["index[",e[h],"]=j",h].join(""));for(var h=0;s>h;++h){for(var c=["offset"+h],f=r;a>f;++f)c.push(["j",f,"*t",h,"p",e[f]].join(""));p.push(["p",h,"=(",c.join("+"),")"].join(""))}p.push(n(e,t,o));for(var h=r;a>h;++h)p.push("}");return p.join("\n")}function a(r){for(var e=0,t=r[0].length;t>e;){for(var n=1;n<r.length;++n)if(r[n][e]!==r[0][e])return e;++e}return e}function s(r,e,t){for(var n=r.body,o=[],a=[],s=0;s<r.args.length;++s){var i=r.args[s];if(!(i.count<=0)){var u=new RegExp(i.name,"g"),p="",h=e.arrayArgs.indexOf(s);switch(e.argTypes[s]){case"offset":var c=e.offsetArgIndex.indexOf(s),f=e.offsetArgs[c];h=f.array,p="+q"+c;case"array":p="p"+h+p;var l="l"+s,d="a"+h;if(0===e.arrayBlockIndices[h])1===i.count?"generic"===t[h]?i.lvalue?(o.push(["var ",l,"=",d,".get(",p,")"].join("")),n=n.replace(u,l),a.push([d,".set(",p,",",l,")"].join(""))):n=n.replace(u,[d,".get(",p,")"].join("")):n=n.replace(u,[d,"[",p,"]"].join("")):"generic"===t[h]?(o.push(["var ",l,"=",d,".get(",p,")"].join("")),n=n.replace(u,l),i.lvalue&&a.push([d,".set(",p,",",l,")"].join(""))):(o.push(["var ",l,"=",d,"[",p,"]"].join("")),n=n.replace(u,l),i.lvalue&&a.push([d,"[",p,"]=",l].join("")));else{for(var g=[i.name],y=[p],v=0;v<Math.abs(e.arrayBlockIndices[h]);v++)g.push("\\s*\\[([^\\]]+)\\]"),y.push("$"+(v+1)+"*t"+h+"b"+v);if(u=new RegExp(g.join(""),"g"),p=y.join("+"),"generic"===t[h])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(u,[d,"[",p,"]"].join(""))}break;case"scalar":n=n.replace(u,"Y"+e.scalarArgs.indexOf(s));break;case"index":n=n.replace(u,"index");break;case"shape":n=n.replace(u,"shape")}}}return[o.join("\n"),n,a.join("\n")].join("\n").trim()}function i(r){for(var e=new Array(r.length),t=!0,n=0;n<r.length;++n){var o=r[n],a=o.match(/\d+/);a=a?a[0]:"",0===o.charAt(0)?e[n]="u"+o.charAt(1)+a:e[n]=o.charAt(0)+a,n>0&&(t=t&&e[n]===e[n-1])}return t?e[0]:e.join("")}function u(r,e){for(var t=e[1].length-Math.abs(r.arrayBlockIndices[0])|0,u=new Array(r.arrayArgs.length),h=new Array(r.arrayArgs.length),c=0;c<r.arrayArgs.length;++c)h[c]=e[2*c],u[c]=e[2*c+1];for(var f=[],l=[],d=[],g=[],y=[],c=0;c<r.arrayArgs.length;++c){r.arrayBlockIndices[c]<0?(d.push(0),g.push(t),f.push(t),l.push(t+r.arrayBlockIndices[c])):(d.push(r.arrayBlockIndices[c]),g.push(r.arrayBlockIndices[c]+t),f.push(0),l.push(r.arrayBlockIndices[c]));for(var v=[],j=0;j<u[c].length;j++)d[c]<=u[c][j]&&u[c][j]<g[c]&&v.push(u[c][j]-d[c]);y.push(v)}for(var b=["SS"],_=["'use strict'"],w=[],j=0;t>j;++j)w.push(["s",j,"=SS[",j,"]"].join(""));for(var c=0;c<r.arrayArgs.length;++c){b.push("a"+c),b.push("t"+c),b.push("p"+c);for(var j=0;t>j;++j)w.push(["t",c,"p",j,"=t",c,"[",d[c]+j,"]"].join(""));for(var j=0;j<Math.abs(r.arrayBlockIndices[c]);++j)w.push(["t",c,"b",j,"=t",c,"[",f[c]+j,"]"].join(""))}for(var c=0;c<r.scalarArgs.length;++c)b.push("Y"+c);if(r.shapeArgs.length>0&&w.push("shape=SS.slice(0)"),r.indexArgs.length>0){for(var m=new Array(t),c=0;t>c;++c)m[c]="0";w.push(["index=[",m.join(","),"]"].join(""))}for(var c=0;c<r.offsetArgs.length;++c){for(var A=r.offsetArgs[c],k=[],j=0;j<A.offset.length;++j)0!==A.offset[j]&&(1===A.offset[j]?k.push(["t",A.array,"p",j].join("")):k.push([A.offset[j],"*t",A.array,"p",j].join("")));0===k.length?w.push("q"+c+"=0"):w.push(["q",c,"=",k.join("+")].join(""))}var x=p([].concat(r.pre.thisVars).concat(r.body.thisVars).concat(r.post.thisVars));w=w.concat(x),_.push("var "+w.join(","));for(var c=0;c<r.arrayArgs.length;++c)_.push("p"+c+"|=0");r.pre.body.length>3&&_.push(s(r.pre,r,h));var I=s(r.body,r,h),E=a(y);t>E?_.push(o(E,y[0],r,I)):_.push(n(y[0],r,I)),r.post.body.length>3&&_.push(s(r.post,r,h)),r.debug&&console.log("-----Generated cwise routine for ",e,":\n"+_.join("\n")+"\n----------");var B=[r.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",E,i(h)].join(""),M=new Function(["function ",B,"(",b.join(","),"){",_.join("\n"),"} return ",B].join(""));return M()}var p=t(9);r.exports=u},function(r,e){"use strict";function t(r,e){for(var t=1,n=r.length,o=r[0],a=r[0],s=1;n>s;++s)if(a=o,o=r[s],e(o,a)){if(s===t){t++;continue}r[t++]=o}return r.length=t,r}function n(r){for(var e=1,t=r.length,n=r[0],o=r[0],a=1;t>a;++a,o=n)if(o=n,n=r[a],n!==o){if(a===e){e++;continue}r[e++]=n}return r.length=e,r}function o(r,e,o){return 0===r.length?r:e?(o||r.sort(e),t(r,e)):(o||r.sort(),n(r))}r.exports=o}])});
//# sourceMappingURL=ndarray-chunk.min.js.map
